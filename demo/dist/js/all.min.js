angular.module("movieCat",["ui.router","routerModule","serviceModule","coming_soonModule","in_theatersModule","searchModule","topModule"]).controller("navBarCtrl",["$scope","$location",function(o,e){o.search=function(){console.log(o.keyword),e.path("/search/1/"+o.keyword),o.keyword=""}}]),angular.module("routerModule",[]).config(["$stateProvider","$urlRouterProvider",function(o,e){o.state({url:"/in_theaters/:page",templateUrl:"./views/in_theaters/in_theaters.html",name:"in_theaters",controller:"movieCtrl"}).state({url:"/search/:page/:keyword",templateUrl:"./views/search/search.html",name:"search",controller:"searchCtrl"}).state({url:"/coming_soon/:page",templateUrl:"./views/coming_soon/coming_soon.html",name:"coming_soon",controller:"coming_soonCtrl"}).state({url:"/top/:page",templateUrl:"./views/top/top.html",name:"top",controller:"topCtrl"}),e.otherwise("/in_theaters/1")}]),angular.module("serviceModule",[]).service("myService",[function(){this.myJsonp=function(o,e,t){var a="myJsonp_"+Math.random().toString().replace(".","");window[a]=t;var n="";for(var r in e)n+=r+"="+e[r]+"&";var c=document.createElement("script");c.src=o+"?"+n+"callback="+a,c.onload=function(){document.body.removeChild(c)},document.body.appendChild(c)}}]),angular.module("coming_soonModule",[]).controller("coming_soonCtrl",["$scope","myService","$stateParams","$location","$rootScope",function(o,e,t,a,n){n.isActive="coming_soon";var r=t.page,c=12*(r-1),l=0;e.myJsonp("https://api.douban.com/v2/movie/coming_soon",{start:c,count:12},function(e){o.result=e,l=Math.ceil(e.total/12),o.$apply()}),o.changePage=function(o){"next"==o?++r>=l&&(r=l):"prev"==o&&--r<=1&&(r=1),a.path("coming_soon/"+r)}}]),angular.module("in_theatersModule",[]).controller("movieCtrl",["$scope","$http","myService","$stateParams","$location","$rootScope",function(o,e,t,a,n,r){r.isActive="in_theaters",console.log(r.isActive);var c=a.page,l=12*(c-1),i=0;t.myJsonp("https://api.douban.com/v2/movie/in_theaters",{start:l,count:12},function(e){o.result=e,i=Math.ceil(e.total/12),o.$apply()}),o.changePage=function(o){"prev"==o?--c<=1&&(c=1):"next"==o&&++c>=i&&(c=i),n.path("/in_theaters/"+c)}}]),angular.module("searchModule",[]).controller("searchCtrl",["$scope","myService","$stateParams","$location",function(o,e,t,a){var n=t.page,r=12*(n-1),c=0,l=t.keyword;e.myJsonp("https://api.douban.com/v2/movie/search",{q:l,count:12,start:r},function(e){o.result=e,c=Math.ceil(e.total/12),o.$apply()}),o.changePage=function(o){"prev"==o?--n<=1&&(n=1):"next"==o&&++n>=c&&(n=c),a.path("/search/"+n+"/"+l)}}]),angular.module("topModule",[]).controller("topCtrl",["$scope","myService","$stateParams","$location","$rootScope",function(o,e,t,a,n){n.isActive="top",console.log(n.isActive);var r=t.page,c=12*(r-1),l=0;e.myJsonp("https://api.douban.com/v2/movie/top250",{start:c,count:12},function(e){o.result=e,l=Math.ceil(e.total/12),o.$apply()}),o.changePage=function(o){"next"==o?++r>=l&&(r=l):"prev"==o&&--r<=1&&(r=1),a.path("top/"+r)}}]);